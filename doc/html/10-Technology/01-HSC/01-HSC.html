<!DOCTYPE html>

<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>S7-1200 高速计数器 &#8212; S7-1200 PLC 技术手册 EasyPlus4.3</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic_mod.css?v=59943e95" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=1a73f00c"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../_static/js/theme.js"></script>
    <script src="../../_static/js/petite-vue.js"></script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="../../index.html" title="Go to homepage"><img src="../../_static/SIEMENS.svg"/></a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="../../search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../base.html">基础总汇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">组态编程</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="s7-1200">
<h1>S7-1200 高速计数器<a class="headerlink" href="#s7-1200" title="此标题的永久链接">¶</a></h1>
<p>本文将从几部分阐述 S7-1200 最新版固件（V4.2
版本及以后）的高速计数器资源及功能，链接如下：</p>
<p><a class="reference internal" href="#01-HSC.html#r"><span class="xref myst">资源</span></a></p>
<p><a class="reference internal" href="#01-HSC.html#a"><span class="xref myst">基础使用</span></a></p>
<p><a class="reference internal" href="#01-HSC.html#e"><span class="xref myst">指令编程</span></a></p>
<p><a class="reference internal" href="#01-HSC.html#o"><span class="xref myst">其他功能</span></a></p>
</section>
<section id="id1">
<h1><span id="r"></span>资源<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h1>
<p>S7-1200 CPU 本体提供了最多 6 路高速计数器，其独立于 CPU
的扫描周期进行计数。其中 CPU1217C 可测量的脉冲频率最高为 1
MHz（差分信号），其它型号的 S7-1200 CPU 可测量到的单相脉冲频率最高为 100
kHz，A/B 相最高为 80 kHz。如果使用信号板还可以测量单相脉冲频率高达
200kHz 的信号，A/B 相最高为 160 kHz。</p>
<p>S7-1200 CPU
和信号板具有可组态的硬件输入地址，因此可测量到的高速计数器频率与高速计数器号无关，而与所使用的
CPU 和信号板的硬件输入地址有关。</p>
<p>表 1 和表 2 显示了 CPU 集成输入点与信号板可用于高速计数器的信息。</p>
<hr class="docutils" />
<p><strong>CPU</strong>                    <strong>CPU 输入通道</strong>                            <strong>单相或两相模式</strong>   <strong>A/B 相正交模式</strong>
CPU1211C                   Ia.0—Ia.5                                 100 kHz              80 kHz
CPU1212(F)C                Ia.0—Ia.5                                 100 kHz              80 kHz
Ia.6—Ia.7                                 30 kHz               20 kHz
CPU1214(F)C、CPU1215(F)C   Ia.0—Ia.5                                 100 kHz              80 kHz
Ia.6—Ib.5                                 30 kHz               20 kHz
CPU1217C                   Ia.0—Ia.5                                 100 kHz              80 kHz
Ia.6—Ib.1                                 30 kHz               20 kHz
Ib.2—Ib.5 (Ib.2+,Ib.2- 到 Ib.5+,Ib.5-）   1 MHz                1 MHz</p>
<hr class="docutils" />
<p>表 1. CPU 集成点输入的最大频率</p>
<hr class="docutils" />
<p>信号板类型                 订货号               <strong>信号板输入通道</strong>   <strong>单相或两相模式</strong>   <strong>A/B 相正交模式</strong>
DI           4×24VDC       6ES7221-3BD30-0XB0   Ie.0—Ie.3          200 kHz              160 kHz
4×5VDC        6ES7221-3AD30-0XB0   Ie.0—Ie.3          200 kHz              160 kHz
DI/DQ        2DI/2×24VDC   6ES7223-0BD30-0XB0   Ie.0—Ie.1          30 kHz               20 kHz
2DI/2×24VDC   6ES7223-3BD30-0XB0   Ie.0—Ie.1          200 kHz              160 kHz
2DI/2×5VDC    6ES7223-3AD30-0XB0   Ie.0—Ie.1          200 kHz              160 kHz</p>
<hr class="docutils" />
<p>表 2. 信号板信息</p>
<p><img alt="" src="../../_images/48.gif" /> 表 2 中的 5V
信号都是集电极开路信号，不是 5V 差分信号。</p>
<p><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>高速计数器所需要的同步输入、硬件门、捕捉输入、比较输出只能使用本体或者信号板的输入输出点。</p>
<p><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>如果希望使用更多的高速计数器，或者连接 SSI
绝对值编码器，可以通过分布式的方式扩展例如 ET200SP
的高速计数器模块，这种方式不占用 S7-1200 高速计数器任何资源。</p>
<p><img alt="" src="../../_images/48.gif" /> 对于 CPU V4.2
版本以前的高速计数器，资源和功能请参见<a class="reference internal" href="#03-HSC_Archive.html"><span class="xref myst">链接</span></a>。</p>
<p><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>有关编码器的相关知识请参考以下链接</p>
<p><img alt="" src="../../_images/35.gif" /> 点击下列链接，打开新浏览器窗口。</p>
<p><a class="reference external" href="https://support.industry.siemens.com/cs/cn/zh/view/79192303"><strong>https://support.industry.siemens.com/cs/cn/zh/view/79192303</strong></a></p>
</section>
<section id="id2">
<h1><span id="a"></span>基础使用<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h1>
<p>在 S7-1200
的硬件组态中，可以配置高速计数器的参数，其中组态成计数模式、频率模式、周期模式需要在这里配置，如图
1 所示。如果是用于闭环运动控制，则此处无需配置。</p>
<p><a class="reference internal" href="../../_images/01-015.png"><img alt="" src="../../_images/01-015.png" style="width: 663px; height: 899px;" /></a></p>
<p>图 1. 基础组态</p>
<p>①激活高速计数器</p>
<p>②设置计数类型：计数模式、频率模式、周期模式</p>
<p>③设置运行模式：单相、两相位、A/B 计数器、A/B
计数器四倍频，值得注意的是组态 A/B 计数器四倍频会使得计数值变为组态 A/B
计数器的 4 倍，但频率相比组态 A/B 计数器不会发生变化</p>
<p>④计数方向：取决于用户程序（通过指令修改），还是外部输入，该功能只与单相计数有关</p>
<p>⑤初始计数方向：正向、反向</p>
<p>⑥频率测量周期：与频率模式、周期模式有关，只能选择
1s、0.1s、0.01s，一般情况下当脉冲频率比较高时选择更小的测量周期可以更新的更加及时，当脉冲频率比较低时选择更大的测量周期可以测量的更准确。</p>
<p>然后在设置使用的硬件输入点，如图 2 所示。</p>
<p><a class="reference internal" href="../../_images/01-024.png"><img alt="" src="../../_images/01-024.png" style="width: 736px; height: 276px;" /></a></p>
<p>图 2. 组态输入</p>
<p><strong><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>注意：对于高速计数器的相关硬件输入点，一般情况下需要设置其滤波时间，具体参见常见问题<a class="reference internal" href="#04-FAQ.html#a"><span class="xref myst">链接</span></a>。</strong></p>
<p>输入点接线与普通 DI
点接线相同，具体参考<a class="reference internal" href="#../../06-IO/02-DIDO/01-wiring.html"><span class="xref myst">链接</span></a>。</p>
<p>在 I/O 地址处查看高速计数器起始地址，默认情况下，HSC1 为 1000，HSC2 为
1004，HSC3 为 1008，HSC4 为 1012，HSC5 为 1016，HSC6 为 1020，如图 3
所示。</p>
<p>如果组态计数模式、频率模式，可以在不使用指令情况下直接读取计数值与频率值。</p>
<p><a class="reference internal" href="../../_images/01-034.png"><img alt="" src="../../_images/01-034.png" style="width: 734px; height: 371px;" /></a></p>
<p>图 3. I/O 地址</p>
<p>在程序中读取基于起始地址的有符号双整数变量即为计数值或者频率值（单位：Hz），一般使用立即读取方式，这样数值更准确，如图
4 所示。</p>
<p><a class="reference internal" href="../../_images/01-044.png"><img alt="" src="../../_images/01-044.png" style="width: 557px; height: 77px;" /></a></p>
<p>图 4. 编程</p>
<p>如果组态为计数模式，则计数启动后，计数值使用组态中的初始计数值开始计数，如图
5 所示。</p>
<p><a class="reference internal" href="../../_images/01-054.png"><img alt="" src="../../_images/01-054.png" style="width: 733px; height: 239px;" /></a></p>
<p>图 5. 初始计数值</p>
<p>当计数正方向达到上限后再继续从下限开始正方向计数，当计数反方向达到下限后再继续从上限开始反方向计数，参考图
5 下方红框设置的上下限。</p>
</section>
<section id="id3">
<h1><span id="e"></span>指令编程<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h1>
<section id="id4">
<h2><span id="b"></span>指令基本介绍<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h2>
<p>在 TIA Portal 软件集成的工艺指令文件夹中可以找到 CTRL_HSC_EXT 与
CTRL_HSC 指令，如图 6 所示。</p>
<p><a class="reference internal" href="../../_images/01-064.png"><img alt="" src="../../_images/01-064.png" style="width: 397px; height: 211px;" /></a></p>
<p>图 6. 指令文件夹</p>
<p>其中 CTRL_HSC_EXT
指令支持所有功能，例如门功能、同步功能、捕捉功能、计数、频率测量、周期测量、修改参数等。</p>
<p>而 CTRL_HSC 指令是从 S7-1200 V1.0
版本就开始支持的旧指令，只支持修改计数方向、参考值、当前值、频率测量周期等参数的功能。</p>
<p>如果只需要计数或者测量频率，以及硬件门、复位计数值为零、比较输出等基本功能，而其他功能都不使用，可以只组态，然后去读取相应计数器地址即可，无需调用指令。</p>
<p>如果除基本功能以外，还需要修改计数方向、参考值、当前值、频率测量周期等参数，可以使用旧指令
CTRL_HSC，该指令使用更为简单。</p>
<p>如果有更多功能需求，则必须使用 CTRL_HSC_EXT 指令。</p>
<p>具体比较参考表 3。</p>
<p>无指令调用   CTRL_HSC     CTRL_HSC_EXT</p>
<hr class="docutils" />
<p>计数测量                 直接读地址   直接读地址   支持
频率测量                 直接读地址   直接读地址   支持
周期测量                                           支持
软件门                                             支持
硬件门                   硬件操作     硬件操作     硬件操作
同步计数值到零           硬件操作     硬件操作     支持
同步计数值到零以外的值                             支持
捕捉功能                                           支持
比较输出                 硬件操作     硬件操作     硬件操作
修改当前计数值                        支持         支持
外部修改计数方向         硬件操作     硬件操作     硬件操作
软件修改计数方向                      支持         支持
修改参考值 1                          支持         支持
修改频率更新周期                      支持         支持
修改计数同步值                                     支持
修改参考值 2                                       支持
修改计数溢出限值                                   支持
修改计数溢出行为                                   支持
事件组态                 支持         支持         支持</p>
<p>表 3. 指令调用比较</p>
<p>CTRL_HSC_EXT 与 CTRL_HSC 指令如图 6 所示。</p>
<p><a class="reference internal" href="../../_images/01-074.png"><img alt="" src="../../_images/01-074.png" style="width: 645px; height: 253px;" /></a></p>
<p>图 7. 指令</p>
<p>CTRL_HSC_EXT 指令各参数含义请参考表 4。CTRL_HSC 指令各参数含义请参考表
5。</p>
<p>参数</p>
<p>声明</p>
<p>数据类型</p>
<p>描述</p>
<p>HSC</p>
<p>IN</p>
<p>HW_HSC</p>
<p>高速计数器硬件标识符</p>
<p>CTRL</p>
<p>IN_OUT</p>
<p>Variant</p>
<p>连接 HSC 参数，支持 HSC_Count、HSC_Frequency 和 HSC_Period
数据类型变量，具体使用参见后文介绍</p>
<p>DONE</p>
<p>OUT</p>
<p>Bool</p>
<p>=1 表示已完成</p>
<p>BUSY</p>
<p>OUT</p>
<p>Bool</p>
<p>始终为 0</p>
<p>ERROR</p>
<p>OUT</p>
<p>Bool</p>
<p>=1 表示错误</p>
<p>STATUS</p>
<p>OUT</p>
<p>Word</p>
<p>执行条件代码</p>
<p>表 4. CTRL_HSC_EXT 各参数含义</p>
<p>±----------------±----------------±----------------±----------------+
| 参数            | 声明            | 数据类型        | 描述            |
±----------------±----------------±----------------±----------------+
| HSC             | IN              | HW_HSC          | 高速计          |
|                 |                 |                 | 数器硬件标识符  |
±----------------±----------------±----------------±----------------+
| DIR             | IN              | Bool            | T               |
|                 |                 |                 | rue：使能新方向 |
±----------------±----------------±----------------±----------------+
| CV              | IN              | Bool            | Tru             |
|                 |                 |                 | e：使能新起始值 |
±----------------±----------------±----------------±----------------+
| RV              | IN              | Bool            | Tru             |
|                 |                 |                 | e：使能新参考值 |
±----------------±----------------±----------------±----------------+
| PERIODE         | IN              | Bool            | True：使能      |
|                 |                 |                 | 新频率测量周期  |
±----------------±----------------±----------------±----------------+
| NEW_DIR         | IN              | Int             | 新方向          |
|                 |                 |                 | 1：=正向；-1    |
|                 |                 |                 | ：=反向         |
±----------------±----------------±----------------±----------------+
| NEW_CV          | IN              | DInt            | 新高            |
|                 |                 |                 | 速计数器起始值  |
±----------------±----------------±----------------±----------------+
| NEW_RV          | IN              | DInt            | 新高            |
|                 |                 |                 | 速计数器参考值  |
±----------------±----------------±----------------±----------------+
| NEW_PERIODE     | IN              | Int             | 新高速          |
|                 |                 |                 | 计数器频率测量  |
|                 |                 |                 | 周期，只能是以  |
|                 |                 |                 | 下三个数值之一  |
|                 |                 |                 |                 |
|                 |                 |                 | -   1000 = 1 秒 |
|                 |                 |                 | -   100 = 0.1   |
|                 |                 |                 |     秒          |
|                 |                 |                 | -   10 = 0.01   |
|                 |                 |                 |     秒          |
±----------------±----------------±----------------±----------------+
| BUSY            | OUT             | Bool            | 始终为 0        |
±----------------±----------------±----------------±----------------+
| STATUS          | OUT             | Word            | 执行条件代码    |
±----------------±----------------±----------------±----------------+</p>
<p>表 5. CTRL_HSC 各参数含义</p>
<p>其中 HSC 参数高速计数器硬件标识符，需要在 PLC 变量表 &gt;
系统常量找到对应标识符，如图 8 所示。</p>
<p><a class="reference internal" href="../../_images/01-084.png"><img alt="" src="../../_images/01-084.png" style="width: 605px; height: 520px;" /></a></p>
<p>图 8. 硬件标识符</p>
</section>
<section id="ctrl-hsc-ext">
<h2><span id="c"></span>CTRL_HSC_EXT 指令-计数实现举例<a class="headerlink" href="#ctrl-hsc-ext" title="此标题的永久链接">¶</a></h2>
<p>1. CPU
硬件组态，启用高速计数器，计数类型选择计数，工作模式选择单相，如图 9
所示。</p>
<p><a class="reference internal" href="../../_images/01-093.png"><img alt="" src="../../_images/01-093.png" style="width: 758px; height: 481px;" /></a></p>
<p>图 9. 计数组态</p>
<p>2. 建立数据块，并建立数据类型为 HSC_Count 的变量，如图 10 所示。</p>
<p><img alt="" src="../../_images/48.gif" />  HSC_Count 数据类型在 DB
块的数据类型中无法选择，需要完整输入后输入回车才会出现。</p>
<p><a class="reference internal" href="../../_images/01-102.png"><img alt="" src="../../_images/01-102.png" style="width: 683px; height: 627px;" /></a></p>
<p>图 10. HSC_Count</p>
<p>3. 在 OB1 里调用指令块 CTRL_HSC_EXT，如图 11 所示。</p>
<p><a class="reference internal" href="../../_images/01-112.png"><img alt="" src="../../_images/01-112.png" style="width: 447px; height: 215px;" /></a></p>
<p>图 11. 调用 CTRL_HSC_EXT</p>
<p>4. CPU 高速计数器通道接入脉冲信号，如图 12
所示，通过程序对高速计数器软件门信号 EnHSC 信号置位，即可在 CurrentCount
处监控到计数值。</p>
<p><a class="reference internal" href="../../_images/01-122.png"><img alt="" src="../../_images/01-122.png" style="width: 516px; height: 632px;" /></a></p>
<p>图 12. 监控计数值</p>
<p><strong>注意：将 HSC 配置成计数模式时调用 CTRL_HSC/CTRL_HSC_EXT
指令不是必须的。只要在硬件配置里使能并组态高速计数器即可正常计数，默认情况下
ID1000 的值即为 HSC1 的计数值。</strong></p>
</section>
<section id="id5">
<h2><span id="f"></span>CTRL_HSC_EXT 指令-频率测量实现举例<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h2>
<p>1. CPU
硬件组态，启用高速计数器，计数类型选择频率，设定频率测量周期，如图 13
所示。</p>
<p><a class="reference internal" href="../../_images/01-132.png"><img alt="" src="../../_images/01-132.png" style="width: 774px; height: 492px;" /></a></p>
<p>图 13. 频率组态</p>
<p>2. 建立数据块，并建立数据类型为 HSC_Frequency 的变量，如图 14 所示。</p>
<p><img alt="" src="../../_images/48.gif" />  HSC_Frequency 数据类型在 DB
块的数据类型中无法选择，需要完整输入后输入回车才会出现。</p>
<p><a class="reference internal" href="../../_images/01-142.png"><img alt="" src="../../_images/01-142.png" style="width: 393px; height: 98px;" /></a></p>
<p>图 14. HSC_Frequency</p>
<p>3. 在 OB1 里调用指令块 CTRL_HSC_EXT，如图 15 所示。</p>
<p><a class="reference internal" href="../../_images/01-151.png"><img alt="" src="../../_images/01-151.png" style="width: 401px; height: 218px;" /></a></p>
<p>图 15. 调用 CTRL_HSC_EXT</p>
<p>4. CPU 高速计数器通道接入脉冲信号，如图 16
所示，通过程序对高速计数器软件门信号 EnHSC 信号置位，即可在 Frequency
处监控到频率值。</p>
<p><a class="reference internal" href="../../_images/01-16.png"><img alt="" src="../../_images/01-16.png" style="width: 511px; height: 95px;" /></a></p>
<p>图 16. 监控频率值</p>
<p><strong>注意：将 HSC 配置成频率模式时调用 CTRL_HSC/CTRL_HSC_EXT
指令不是必须的。只要在硬件配置里使能并组态高速计数器即可正常计数，默认情况下
ID1000 的值即为 HSC1 的频率值。</strong></p>
</section>
<section id="id6">
<h2><span id="p"></span>CTRL_HSC_EXT 指令-周期测量实现举例<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h2>
<p>1. CPU
硬件组态，启用高速计数器，计数类型选择周期，设定频率测量周期，如图 17
所示。</p>
<p><a class="reference internal" href="../../_images/01-171.png"><img alt="" src="../../_images/01-171.png" style="width: 724px; height: 493px;" /></a></p>
<p>图 17. 频率组态</p>
<p>2. 建立数据块，并建立数据类型为 HSC_Period 的变量，如图 18 所示。</p>
<p><img alt="" src="../../_images/48.gif" />  HSC_Period 数据类型在 DB
块的数据类型中无法选择，需要完整输入后输入回车才会出现。</p>
<p><a class="reference internal" href="../../_images/01-181.png"><img alt="" src="../../_images/01-181.png" style="width: 667px; height: 177px;" /></a></p>
<p>图 18. HSC_Period</p>
<p>3. 在 OB1 里调用指令块 CTRL_HSC_EXT，如图 19 所示。</p>
<p><a class="reference internal" href="../../_images/01-191.png"><img alt="" src="../../_images/01-191.png" style="width: 379px; height: 168px;" /></a></p>
<p>图 19. 调用 CTRL_HSC_EXT</p>
<p>4. CPU 高速计数器通道接入脉冲信号，如图 20
所示，通过程序对高速计数器软件门信号 EnHSC
信号置位，可以在线监控数据块的数据变化。</p>
<p><a class="reference internal" href="../../_images/01-20.png"><img alt="" src="../../_images/01-20.png" style="width: 603px; height: 177px;" /></a></p>
<p>图 20. 监控数值</p>
<p>根据周期计算公式，</p>
<p>脉冲周期 = ElapsedTime/EdgeCount = 1000291000/1004 = 996305 ns ≈ 0.001 s</p>
<p>由此可以得出所测量的脉冲信号周期为 0.001 秒。</p>
</section>
</section>
<section id="id7">
<h1><span id="o"></span>其他功能<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h1>
<p>高速计数器还支持其他功能，包括：</p>
<ul class="simple">
<li><p>门功能</p></li>
<li><p>同步功能</p></li>
<li><p>捕捉功能</p></li>
<li><p>比较功能</p></li>
<li><p>事件组态</p></li>
<li><p>变量修改</p></li>
</ul>
<section id="id8">
<h2>门功能<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h2>
<p>许多应用需要根据其他事件的情况来开启或关闭计数程序。出现这类情况时，便会通过内部门功能来开启或关闭计数。每个高速计数器通道有两个门：软件门和硬件门。这些门的状态将决定内部门的状态参见表
6 所示。</p>
<p>硬件门        软件门        内部门</p>
<hr class="docutils" />
<p>打开/未组态   打开/未编程   打开
打开/未组态   关闭          关闭
关闭          打开/未编程   关闭
关闭          关闭          关闭</p>
<p>表 6. 内部门状态</p>
<p>如果硬件门处于打开状态或尚未进行组态，并且软件门处于打开状态或没有编写
CTRL_HSC_EXT
指令，则内部门会打开。如果内部门打开，则开始计数。如果内部门关闭，则会忽略计数脉冲，且停止计数。如图
21 所示。</p>
<p><strong><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>注意：内部门关闭之后再打开，计数器将继续之前的数值计数，而并非从初始计数值开始计数。</strong></p>
<p><a class="reference internal" href="../../_images/01-21.png"><img alt="" src="../../_images/01-21.png" style="width: 817px; height: 403px;" /></a></p>
<p>图 21. 内部门与计数器值</p>
<p>硬件门组态，如图 22 所示。</p>
<p><a class="reference internal" href="../../_images/01-22.png"><img alt="" src="../../_images/01-22.png" style="width: 735px; height: 678px;" /></a></p>
<p>图 22. 硬件门组态</p>
<p>软件门编程</p>
<p>当使用 CTRL_HSC_EXT 指令时，需要根据测量类型新建数据类型为 HSC_Count
、HSC_Frequency 或 HSC_Period 的变量连接在指令的 CTRL
接口，软件门即为该变量中的 EnHSC，如图 23 所示为 HSC_Count 的
EnHSC。HSC_Frequency 和 HSC_Period 的 EnHSC 请参考图 14 和 18。</p>
<p><a class="reference internal" href="../../_images/01-23.png"><img alt="" src="../../_images/01-23.png" style="width: 487px; height: 422px;" /></a></p>
<p>图 23. 软件门</p>
<p><strong>注意：硬件门功能仅可用在组态计数模式的 HSC
时使用。在&quot;周期&quot;和&quot;频率&quot;模式下，内部门的状态与软件门的状态相同。</strong></p>
<p><strong>软件门功能仅在使用 CTRL_HSC_EXT
指令时有效，当不使用该指令时相当于软件门已打开。</strong></p>
</section>
<section id="id9">
<h2><span id="s"></span>同步功能<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h2>
<p>同步功能通过外部输入信号给计数器设置为起始值。可通过执行 CTRL_HSC_EXT
指令对起始值进行更改。这样，用户可以将当前计数值与起始值通过外部输入信号进行值同步，同步示例如图
24 所示。</p>
<p><img alt="" src="../../_images/35.gif" />该功能仅在计数模式下使用。</p>
<p><strong><a class="reference internal" href="../../_images/48.gif"><img alt="" src="../../_images/48.gif" style="width: 15px; height: 15px;" /></a>注意：即使内部门没有打开也将同步。</strong></p>
<p><a class="reference internal" href="../../_images/01-24.png"><img alt="" src="../../_images/01-24.png" style="width: 822px; height: 482px;" /></a></p>
<p>图 24. 同步示例</p>
<p>硬件组态，如图 25 所示。</p>
<p><a class="reference internal" href="../../_images/01-25.png"><img alt="" src="../../_images/01-25.png" style="width: 736px; height: 599px;" /></a></p>
<p>图 25. 同步输入组态</p>
<p>软件部分，两种情况：</p>
<p>1. 不调用 CTRL_HSC_EXT 指令</p>
<p>此时同步信号电平满足组态条件，计数值将修改为 0
即初始计数值，但是无法修改该初始计数值。</p>
<p>2. 调用 CTRL_HSC_EXT 指令</p>
<p>需要新建数据类型为 HSC_Count 的变量连接在指令的 CTRL
接口，同步输入的使能 EnSync
需要置位，然后同步信号电平满足组态条件时就可以实现同步功能，计数值将修改为初始计数值，默认为
0。变量如图 26 所示。</p>
<p><a class="reference internal" href="../../_images/01-26.png"><img alt="" src="../../_images/01-26.png" style="width: 395px; height: 626px;" /></a></p>
<p>图 26. 同步使能信号</p>
<p>如果需要修改初始计数值，使用 CTRL_HSC_EXT 可以通过将变量 EN_SV
置位，为变量 NewStartValue
赋值新的初始计数值，即修改了初始计数值。这样同步功能将计数值同步为新的初始计数值，变量如图
27 所示。</p>
<p><a class="reference internal" href="../../_images/01-27.png"><img alt="" src="../../_images/01-27.png" style="width: 394px; height: 627px;" /></a></p>
<p>图 27. 修改初始值</p>
<p><strong>注意：CPU 启动后第一次计数时值为组态页面中的&quot;初始计数器值&quot;，参考图 5
上方红框。该&quot;初始计数器值&quot;仅用于此时，与同步功能无关。</strong></p>
</section>
<section id="id10">
<h2>捕捉功能<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h2>
<p>可使用捕捉功能通过外部输入信号来保存当前计数值。需要通过执行
CTRL_HSC_EXT 指令才可实现。</p>
<p><img alt="" src="../../_images/35.gif" />该功能仅在计数模式下使用。</p>
<p>如图 28 所示组态捕捉功能在上升沿上进行捕捉的示例。</p>
<p><a class="reference internal" href="../../_images/01-28.png"><img alt="" src="../../_images/01-28.png" style="width: 816px; height: 506px;" /></a></p>
<p>图 28. 捕捉示例</p>
<p>捕捉外部输入组态，如图 29 所示。</p>
<p><a class="reference internal" href="../../_images/01-29.png"><img alt="" src="../../_images/01-29.png" style="width: 735px; height: 756px;" /></a></p>
<p>图 29. 捕捉输入组态</p>
<p>使用 CTRL_HSC_EXT 指令时，需要根据测量类型新建数据类型为 HSC_Count
连接在指令的 CTRL 接口，捕捉输入的使能 EnCapture
需要置位，然后捕捉信号电平满足组态条件时，当前计数值捕捉到变量
CapturedCount 即实现了捕捉功能，如图 30 所示。</p>
<p><a class="reference internal" href="../../_images/01-30.png"><img alt="" src="../../_images/01-30.png" style="width: 394px; height: 625px;" /></a></p>
<p>图 30. 捕捉位及捕捉值</p>
<p><strong>注意： 必须调用 CTRL_HSC_EXT
指令获取捕捉计数值，在内部门关闭后捕捉功能仍然有效。输入点功能仅可用在组态计数模式的
HSC 时使用。</strong></p>
</section>
<section id="id11">
<h2>比较功能<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h2>
<p>启用&quot;比较&quot;输出值功能会生成一个可组态脉冲，每次发生组态的事件时便会产生脉冲。如果正在输出脉冲期间又发生了组态的事件，则该事件不会产生新的脉冲。如图
31 所示比较功能的示例。</p>
<p><a class="reference internal" href="../../_images/01-31.png"><img alt="" src="../../_images/01-31.png" style="width: 645px; height: 378px;" /></a></p>
<p>图 31. 比较功能示例</p>
<p>比较功能参考值组态，如图 32 所示。</p>
<p><a class="reference internal" href="../../_images/01-32.png"><img alt="" src="../../_images/01-32.png" style="width: 736px; height: 240px;" /></a></p>
<p>图 32. 参考值组态</p>
<p>比较输出组态，如图 33 所示。</p>
<p><a class="reference internal" href="../../_images/01-33.png"><img alt="" src="../../_images/01-33.png" style="width: 735px; height: 556px;" /></a></p>
<p>图 33. 比较输出</p>
<p><strong>注意：需要更改参考计数值除了更改组态外还可以通过
CTRL_HSC（只支持参考值 1） 与 CTRL_HSC_EXT 指令更改，如果需要由参考计数
1 改为参考计数 2，只能通过组态来更改</strong>。
<strong>输出功能仅可在组态计数模式时使用</strong>。</p>
</section>
<section id="id12">
<h2><span id="d"></span>事件组态<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h2>
<p>如果需要在高速计数器的某些情况下，迅速做出反应，可以使用高速计数器的事件功能，该功能将触发相应的硬件中断，在硬件中断中编写相关工艺程序实现迅速反应。</p>
<p>S7-1200 高速计数器支持三种事件：</p>
<ul class="simple">
<li><p>计数值等于参考值 1（仅支持计数模式）</p></li>
<li><p>同步事件（仅支持计数模式）</p></li>
<li><p>方向信号改变（仅支持单相模式外部方向信号）</p></li>
</ul>
<p>如图 34 所示了组态页面。</p>
<p><a class="reference internal" href="../../_images/01-34.png"><img alt="" src="../../_images/01-34.png" style="width: 737px; height: 529px;" /></a></p>
<p>图 34. 事件组态</p>
<p>使用哪一个事件则激活该事件以及对应硬件中断，然后在中断中编写程序，示例参见<a class="reference internal" href="#02-Sample.html"><span class="xref myst">链接</span></a>。</p>
</section>
<section id="id13">
<h2><span id="m"></span>修改参数<a class="headerlink" href="#id13" title="此标题的永久链接">¶</a></h2>
<p>如果要修改高速计数器的参数，例如修改当前计数值，必须使用指令才可以，CTRL_HSC_EXT
与 CTRL_HSC 指令支持修改的参数不同，具体参考表 7。</p>
<p>CTRL_HSC   CTRL_HSC_EXT</p>
<hr class="docutils" />
<p>修改当前计数值     支持       支持
软件修改计数方向   支持       支持
修改参考值 1       支持       支持
修改频率更新周期   支持       支持
修改计数同步值                支持
修改参考值 2                  支持
修改计数溢出限值              支持
修改计数溢出行为              支持</p>
<p>表 7. 参数修改比较</p>
<p>对于 CTRL_HSC
指令，修改参数比较简单，直接在指令输入端控制即可。每个参数有值和控制位两个参数，对参数值进行修改，然后对控制位置位即可修改相关参数。</p>
<p>如表 8
所示，前四个参数时控制位，后四个参数是前四个对应的参数值。以修改计数值为例，只需在
NEW_CV 赋值希望的修改的计数值，然后对 CV
置位即可修改完成，但是要注意如果 CV
一直是高电平，此时计数值会保持为修改的计数值无法计数，所以通常使用沿指令触发控制位。</p>
<p>±----------------------±----------------------±----------------------+
| 参数                  | 数据类型              | 描述                  |
±----------------------±----------------------±----------------------+
| DIR                   | Bool                  | True：使能新方向      |
±----------------------±----------------------±----------------------+
| CV                    | Bool                  | True：使能新起始值    |
±----------------------±----------------------±----------------------+
| RV                    | Bool                  | True：使能新参考值 1  |
±----------------------±----------------------±----------------------+
| PERIODE               | Bool                  | Tru                   |
|                       |                       | e：使能新频率测量周期 |
±----------------------±----------------------±----------------------+
| NEW_DIR               | Int                   | 新方向 1：=正向；-1   |
|                       |                       | ：=反向               |
±----------------------±----------------------±----------------------+
| NEW_CV                | DInt                  | 新高速计数器起始值    |
±----------------------±----------------------±----------------------+
| NEW_RV                | DInt                  | 新高速计数器参考值 1  |
±----------------------±----------------------±----------------------+
| NEW_PERIODE           | Int                   | 新高速计              |
|                       |                       | 数器频率测量周期，只  |
|                       |                       | 能是以下三个数值之一  |
|                       |                       |                       |
|                       |                       | -   1000 = 1 秒       |
|                       |                       | -   100 = 0.1 秒      |
|                       |                       | -   10 = 0.01 秒      |
±----------------------±----------------------±----------------------+</p>
<p>表 8. CTRL_HSC 指令修改参数</p>
<p>对于 CTRL_HSC_EXT 指令，需要根据测量类型新建数据类型为 HSC_Count
、HSC_Frequency 或 HSC_Period 的变量连接在指令的 CTRL
接口，需要修改的参数就在这三个变量中。</p>
<p>其中 HSC_Frequency 与 HSC_Period 只能修改频率更新周期，如图 35 所示。在
NewPeriod 中赋值新的频率更新周期，然后对 EnPeriod
置位即可修改完成，和前述相同，通常使用沿指令触发 EnPeriod 位。</p>
<p>注意：该值只能修改为 1000（对应 1000ms）、100（对应 100ms）、10（对应
10ms）。</p>
<p><a class="reference internal" href="../../_images/01-35.png"><img alt="" src="../../_images/01-35.png" style="width: 373px; height: 212px;" /></a></p>
<p>图 35. 修改频率更新周期</p>
<p>对于 HSC_Count，可以修改的参数很多，具体详见表 9。思路和上面的 NewPeriod
相同，在参数值处修改变量，然后对相关控制位进行置位，通常使用沿指令触发控制位。</p>
<p>元素                数据类型   说明</p>
<hr class="docutils" />
<p>EnDir               Bool       新计数方向 NewDirection 控制位
EnCV                Bool       新当前计数值 NewCurrentCount 控制位
EnSV                Bool       新同步起始值 NewStartValue 控制位
EnReference1        Bool       新参考值 1 NewReference1 控制位
EnReference2        Bool       新参考值 2 NewReference2 控制位
EnUpperLmt          Bool       新计数上限值 NewUpperLimit 控制位
EnLowerLmt          Bool       新计数下限值 New_Lower_Limit 控制位
EnOpMode            Bool       新溢出行为 NewOpModeBehavior 控制位
EnLmtBehavior       Bool       溢出时新计数值 NewLimitBehavior 控制位
EnSyncBehavior      Bool       暂时不使用
NewDirection        Int        新计数方向：1 = 加计数；-1 = 减计数
NewOpModeBehavior   Int        新溢出行为：1 = 停止计数（内部门关闭打开才能继续计数）；2 = 继续计数
NewLimitBehavior    Int        溢出时新计数值：1 = 计数相反方向限值；2 = 同步起始值（未修改时为 0 ，修改后为生效的 NewStartValue）
NewSyncBehavior     Int        暂时不使用
NewCurrentCount     DInt       新当前计数值
NewStartValue       DInt       新同步起始值
NewReference1       DInt       新参考值 1
NewReference2       DInt       新参考值 2
NewUpperLimit       DInt       新计数上限值
New_Lower_Limit     DInt       新计数下限值</p>
<p>表 9. 修改 HSC_Count 参数</p>
<p>具体修改实例可以参见<a class="reference internal" href="#02-Sample.html"><span class="xref myst">链接</span></a>。</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">S7-1200 高速计数器</a></li>
<li><a class="reference internal" href="#id1"><span id="r"></span>资源</a></li>
<li><a class="reference internal" href="#id2"><span id="a"></span>基础使用</a></li>
<li><a class="reference internal" href="#id3"><span id="e"></span>指令编程</a><ul>
<li><a class="reference internal" href="#id4"><span id="b"></span>指令基本介绍</a></li>
<li><a class="reference internal" href="#ctrl-hsc-ext"><span id="c"></span>CTRL_HSC_EXT 指令-计数实现举例</a></li>
<li><a class="reference internal" href="#id5"><span id="f"></span>CTRL_HSC_EXT 指令-频率测量实现举例</a></li>
<li><a class="reference internal" href="#id6"><span id="p"></span>CTRL_HSC_EXT 指令-周期测量实现举例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7"><span id="o"></span>其他功能</a><ul>
<li><a class="reference internal" href="#id8">门功能</a></li>
<li><a class="reference internal" href="#id9"><span id="s"></span>同步功能</a></li>
<li><a class="reference internal" href="#id10">捕捉功能</a></li>
<li><a class="reference internal" href="#id11">比较功能</a></li>
<li><a class="reference internal" href="#id12"><span id="d"></span>事件组态</a></li>
<li><a class="reference internal" href="#id13"><span id="m"></span>修改参数</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; 版权所有 2024, 宁波双紫信息科技有限公司.
      最后更新于 8月 24, 2024.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2创建。
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>