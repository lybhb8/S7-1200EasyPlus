<!DOCTYPE html>

<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>S7-1200 运动控制的常见问题 &#8212; S7-1200 PLC 技术手册 EasyPlus4.3</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic_mod.css?v=59943e95" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=1a73f00c"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script src="../../../_static/js/theme.js"></script>
    <script src="../../../_static/js/petite-vue.js"></script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="../../../index.html" title="Go to homepage"><img src="../../../_static/SIEMENS.svg"/></a></h1>

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="../../../search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../base.html">基础总汇</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../config.html">组态编程</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="s7-1200">
<h1><span id="toc428444757">S7-1200 运动控制的常见问题</span><a class="headerlink" href="#s7-1200" title="此标题的永久链接">¶</a></h1>
<p>本页面仅针对除回原点、轴位置以外的常见问题，回原点、轴位置常见问题参见<a class="reference internal" href="#02-HOME_FAQ.html"><span class="xref myst">链接</span></a>。</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="02-HOME_FAQ%20-%20%5BUTF-8%5D.html#toc"><span class="std std-ref">绝对定位和相对定位区别？</span></a></p></li>
<li><p><a class="reference internal" href="02-HOME_FAQ%20-%20%5BUTF-8%5D.html#toc2"><span class="std std-ref">如何设置 MC_MoveRelative 方向运行？</span></a></p></li>
<li><p><a class="reference internal" href="02-HOME_FAQ%20-%20%5BUTF-8%5D.html#toc3"><span class="std std-ref">为什么有时用户在监控程序的时候看不到指令的完成位 Done 的为
1？</span></a></p></li>
<li><p><a class="reference internal" href="../10-Resource_Archive.html#toc4"><span class="std std-ref">开环运动控制怎样计算运动任务？</span></a></p></li>
<li><p><a class="reference internal" href="../10-Resource_Archive.html#toc5"><span class="std std-ref">为何通过 S7-1200 PTO 方式控制 V90 PTI
定位换向时有时会有丢失脉冲的情况？</span></a></p></li>
<li><p><a class="reference internal" href="../10-Resource_Archive.html#toc6"><span class="std std-ref">如何通过数据块实现驱动装置/编码器的数据连接？</span></a></p></li>
<li><p><a class="reference internal" href="../10-Resource_Archive.html#toc7"><span class="std std-ref">S7-1200 工艺对象能否控制由硬件支持包（HSP）方式组态的 V90
PN?</span></a></p></li>
<li><p><a class="reference internal" href="../10-Resource_Archive.html#toc8"><span class="std std-ref">如何在轴运动过程中修改目标速度与目标位置？</span></a></p></li>
<li><p><a class="reference internal" href="02-HOME_FAQ%20-%20%5BUTF-8%5D.html#toc9"><span class="std std-ref">在运行期间如何对工艺对象的变量进行读写访问</span></a></p></li>
<li><p><a class="reference internal" href="#toc10"><span class="std std-ref">如何在闭环控制时正确使能 MC_POWER ？</span></a></p></li>
<li><p><a class="reference internal" href="#toc11"><span class="std std-ref">如何对运动控制指令使用 FB 进行封装？<br />
</span></a></p></li>
</ol>
<section id="id1">
<h2><span id="toc"></span>1. 绝对定位和相对定位区别？<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>相对定位是指在轴当前位置的基础上正方向或负方向移动一段距离；</p>
<p>绝对定位指的是当轴建立了绝对坐标系后，轴的每个位置都有固定的坐标，无论轴的当前位置值是多少，当轴指令了绝对运行指令后相同的坐标值，轴最终都定位到同一个位置。</p>
</section>
<section id="mc-moverelative">
<h2><span id="toc2"></span>2. 如何设置 MC_MoveRelative 方向运行？<a class="headerlink" href="#mc-moverelative" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>将 MC_MoveRelative
指令中的&quot;Distance&quot;设置成负值就可以让轴向负方向运行了。如图 1 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-01.jpg"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-01.jpg" style="width: 559px; height: 259px;" /></a></p>
<p>图 1. 相对运动</p>
</section>
<section id="done-1">
<h2><span id="toc3"></span>3. 为什么有时用户在监控程序的时候看不到指令的完成位 Done 的为 1？<a class="headerlink" href="#done-1" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>带有 Execute 管脚的指令，例如 MC_MoveRelative 等指令的 Done 和 Execute
之间有下如图 2 所示描述的关系：</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-02.jpg"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-02.jpg" style="width: 924px; height: 834px;" /></a></p>
<p>图 2. 引脚说明</p>
<p>如果&quot;Execute&quot;在命令执行完成之前设置为
FALSE，则&quot;Done&quot;的值仅在一个执行周期内为
TRUE。因此，如果用户用|P|指令触发带有&quot;Execute&quot;管脚的指令，则该指令的&quot;Done&quot;只在一个扫描周期内为
1，因此在监控程序时看不到 Done 位为 1。用户可以通过在程序中添加指令用
Done 置位一个位来判断，如图 3 所示，用 MC_MoveRelative 为例进行说明。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-03.jpg"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-03.jpg" style="width: 584px; height: 569px;" /></a></p>
<p>图 3. 例程</p>
</section>
<section id="id2">
<h2><span id="toc4"></span>4. 开环运动控制怎样计算运动任务？<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>S7-1200 默认以 10ms 为&quot;时间片&quot;计算运动任务，如图 4
所示，执行一个时间片时，下一时间片会在队列中等待执行。如果执行轴的新运动任务（例如通过&quot;MC_MoveVelocity&quot;实现速度控制时，更新速度值），新运动任务可能最多等待
20ms（当前时间片的剩余时间加上排队的时间片）后才执行生效。使用&quot;MC_Halt&quot;运动控制指令停止轴以及利用&quot;MC_Power&quot;指令的&quot;Enable&quot;输入引脚停止轴时，也要遵循时间片机制，轴停止也会延时
1-2 时间片（10-20ms）才生效。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-04.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-04.png" style="width: 716px; height: 349px;" /></a></p>
<p>图 4. 时间片</p>
<p>从 V4.4 固件版本以后，工艺对象 V7.0开始，如图 5
所示，可以在工艺对象对应的 DB
中修改时间片时间&quot;Static-&gt;Actor-&gt;PTOSliceTime&quot;，修改范围为 2-
20ms。在一些需要快速响应的应用可以考虑减小时间片，例如：贴标机。如果希望降低
CPU 的运算负荷，可以考虑增大时间片时间。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-05.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-05.png" style="width: 1179px; height: 390px;" /></a></p>
<p>图 5. 参数</p>
</section>
<section id="s7-1200-pto-v90-pti">
<h2><span id="toc5"></span>5. 为何通过 S7-1200 PTO 方式控制 V90 PTI 定位换向时有时会有丢失脉冲的情况?<a class="headerlink" href="#s7-1200-pto-v90-pti" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>S7-1200 PTO 方式控制 V90 PTI
定位换向时，换向信号由高电平转换为低电平状态的时间取决于外围电路的输入电阻和电容，如果方向输出点的负载电流过小（应不小于
10%），在高速时输出信号波形会发生畸变，换向切换时间过长，导致换向过程中的脉冲丢失。为确保换向时不丢失脉冲，同时保证脉冲输出信号波形不发生畸变，建议在
V90 PTI 的方向控制信号 38、39 和脉冲信号 36、37 的端子间连接阻值为 200Ω
至 500Ω;，最小功率为 5W 的下拉电阻，接线如图 6 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-06.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-06.png" style="width: 940px; height: 922px;" /></a></p>
<p>图 6. 接线图</p>
</section>
<section id="id3">
<h2><span id="toc6"></span>6. 如何通过数据块实现驱动装置/编码器的数据连接？<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>PROFIdrive 驱动装置和 PROFIdrive 编码器可通过 PROFIdrive
报文或数据块建立数据连接。出于控制过程特定的原因（例如非线性的液压轴的控制），如果要修改或评估用户程序中的报文内容时，则需通过数据块建立连接。组态如图
7、图 8 所示</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-07.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-07.png" style="width: 476px; height: 213px;" /></a></p>
<p>图 7. 驱动器数据块连接</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-08.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-08.png" style="width: 476px; height: 212px;" /></a></p>
<p>图 8. 编码器数据块连接</p>
<p>通过数据块建立数据连接的操作原理如下：</p>
<p>通常，轴闭环位置控制开始时，将通过 MC-Servo[OB91]
读取驱动装置或编码器的输入报文。闭环位置控制结束时，将输出报文写入驱动装置或编码器中。由于过程特定的原因要修改或评估报文内容时，必须在闭环位置控制前后通过数据块在驱动装置和编码器之间连接数据接口。</p>
<ul class="simple">
<li><p>通过 MC-PreServo[OB67] 组织块，可编辑报文的输入区域。在 MC-Servo
前调用 MC-PreServo；</p></li>
<li><p>通过 MC-PostServo[OB95] 组织块，可编辑报文的输出区域，在 MC-Servo
后调用 MC-PostServo。</p></li>
</ul>
<p>用户可对 MC-PreServo 和 MC-PostServo 组织块进行编程，通过 PROFIdrive
报文以及数据块建立数据连接的操作原理如图 9 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-09.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-09.png" style="width: 903px; height: 580px;" /></a></p>
<p>图 9. 操作原理</p>
<p>数据块由用户创建，其中需包含数据类型为&quot;PD_TELx&quot;的数据结构，以进行数据连接，&quot;x&quot;表示在设备组态中组态的驱动装置或编码器的报文编号。如图
10 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-10.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-10.png" style="width: 496px; height: 308px;" /></a></p>
<p>图 10. 数据块</p>
<p>在数据块&quot;属性&quot;选项中，需<strong>禁用</strong>以下属性，如图 11 所示：</p>
<ul class="simple">
<li><p>&quot;仅存储在装载存储器中&quot;(Only store in load memory)</p></li>
<li><p>&quot;设备中的写保护数据块&quot;(Data block write-protected in the device)</p></li>
<li><p>&quot;优化块访问&quot;(Optimized block access)*</p></li>
</ul>
<p><img alt="" src="10-Technology/03-MC/08-FAQ/images/4.gif" /> *：从 V4.4
固件版本以后，工艺对象 V7.0 开始，可以使用优化块</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-11.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-11.png" style="width: 474px; height: 230px;" /></a></p>
<p>图 11. 块设置</p>
<p>具体应用请参考以下链接：</p>
<p><strong>使用 MC-PreServo 和 MC-PostServo 组织块</strong></p>
<p><a class="reference external" href="https://support.industry.siemens.com/cs/cn/zh/view/109741575"><strong>https://support.industry.siemens.com/cs/cn/zh/view/109741575</strong></a></p>
</section>
<section id="s7-1200-hsp-v90-pn">
<h2><span id="toc7"></span>7. S7-1200 工艺对象能否控制由硬件支持包（HSP）方式组态的 V90 PN?<a class="headerlink" href="#s7-1200-hsp-v90-pn" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>从 TIA Portal V16 开始 S7-1200
工艺对象可以控制由硬件支持包（HSP）方式组态的驱动器，以前版本只能控制由
GSD 文件组态的 V90 PN 驱动器。使用硬件支持包组态的 V90 PN
驱动装置，可实现下述功能：</p>
<ul class="simple">
<li><p>驱动器诊断、参数保存/复位相关功能</p></li>
<li><p>电机和编码器配置、极限值、抱闸等基本配置</p></li>
<li><p>驱动器控制面板测试运行、驱动器优化</p></li>
</ul>
</section>
<section id="id4">
<h2><span id="toc8"></span>8. 如何在轴运动过程中修改目标速度与目标位置？<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>可以利用轴控制指令的超驰功能实现，用新的指令覆盖正在执行的命令以中止当前动作切换到新的命令，详见<a class="reference internal" href="#../06-Instruction/13-Override.html"><span class="xref myst">链接</span></a>。</p>
</section>
<section id="id5">
<h2><span id="toc9"></span>9. 在运行期间如何对工艺对象的变量进行读写访问<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>在程序中对工艺对象的变量进行读写访问的方法见表 1：</p>
<p>表 1. 访问缩写</p>
<p>±----------------------±----------------------±----------------------+
| 访问                  | R                     | ::: {align=“left”}    |
|                       |                       | 在用户程序和 HMI      |
|                       |                       | 中，可读取该变量      |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | RCCP                  | ::: {align=“left”}    |
|                       |                       | 该变量可在用户程序和  |
|                       |                       | HMI                   |
|                       |                       | 中读取，并在每个      |
|                       |                       | 周期控制点处进行更新  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | RP                    | ::: {align=“left”}    |
|                       |                       | 该                    |
|                       |                       | 变量可通过运动控制指  |
|                       |                       | 令&quot;MC_ReadParam&quot;进行  |
|                       |                       | 读取，相应变量的当前  |
|                       |                       | 值将在命令启动时确定  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | RW                    | ::: {align=“left”}    |
|                       |                       | 在用户程序和 HMI      |
|                       |                       | 中                    |
|                       |                       | ，可读写该变量，该变  |
|                       |                       | 量可通过运动控制指令  |
|                       |                       | &quot;M                    |
|                       |                       | C_WriteParam&quot;进行写入 |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | WP                    | ::: {align=“left”}    |
|                       |                       | 与驱动装置连接        |
|                       |                       | 无关：如果该轴已禁用  |
|                       |                       | (MC_Power.Status =    |
|                       |                       | F                     |
|                       |                       | ALSE)，则可使用运动控 |
|                       |                       | 制指令&quot;MC_WriteParam  |
|                       |                       | &quot;对该变量进行写入操作 |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | WP_PD                 | ::: {align=“left”}    |
|                       |                       | 通过                  |
|                       |                       | PROFIdrive/模         |
|                       |                       | 拟量输出进行驱动装置  |
|                       |                       | 连接：如果该轴已禁用  |
|                       |                       | (MC_Power.Status =    |
|                       |                       | F                     |
|                       |                       | ALSE)，则可使用运动控 |
|                       |                       | 制指令&quot;MC_WriteParam  |
|                       |                       | &quot;对该变量进行写入操作 |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | WP_PTO                | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱动装置          |
|                       |                       | 连接：如果该轴已禁用  |
|                       |                       | (MC_Power.Status =    |
|                       |                       | F                     |
|                       |                       | ALSE)，则可使用运动控 |
|                       |                       | 制指令&quot;MC_WriteParam  |
|                       |                       | &quot;对该变量进行写入操作 |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | -                    | ::: {align=“left”}    |
|                       |                       | 变量不能在程序中使用  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+</p>
<p>工艺对象更改后的生效方式见表 2：</p>
<p>表 2. 更改有效性</p>
<p>±----------------------±----------------------±----------------------+
| W                     | ::: {align=“left”}    |                       |
|                       | 工艺                  |                       |
|                       | 数据块中更改的有效性  |                       |
|                       | :::                   |                       |
±----------------------±----------------------±----------------------+
|                       | 1                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进                    |
|                       |                       | 行驱动装置连接：在轴  |
|                       |                       | 激活、禁用或已启用时  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 2                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱                |
|                       |                       | 动装置连接：轴启用时  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 5                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱动              |
|                       |                       | 装置连接：下一次启动  |
|                       |                       | MC_MoveAbsolute、     |
|                       |                       | MC_MoveRelati         |
|                       |                       | ve、MC_MoveVelocity、 |
|                       |                       | MC_MoveJog、MC_Halt、 |
|                       |                       | MC_CommandTable       |
|                       |                       | 或激活的 MC_Home      |
|                       |                       | 命令时 (Mode = 3)     |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 6                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱动              |
|                       |                       | 装置连接：MC_MoveJog  |
|                       |                       | 命令停止时            |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 7                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱动装置连接：    |
|                       |                       | 启动被动回原地命令时  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 8                     | ::: {align=“left”}    |
|                       |                       | 通过 PTO              |
|                       |                       | 进行驱动装置连接：    |
|                       |                       | 启动主动回原地命令时  |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 9                     | ::: {align=“left”}    |
|                       |                       | 重新启动工艺对象时    |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+
|                       | 10                    | ::: {align=“left”}    |
|                       |                       | 通过                  |
|                       |                       | PROFIdri              |
|                       |                       | ve/模拟量输出进行驱动 |
|                       |                       | 装置连接：下一次调用  |
|                       |                       | MC-Interpolator       |
|                       |                       | [OB92] 时           |
|                       |                       | :::                   |
±----------------------±----------------------±----------------------+</p>
<p>变量支持的访问及更改后的生效方式详见&quot;S7-1200
运动控制使用手册&quot;附录中&quot;定位轴工艺对象的变量&quot;章节的描述，手册可以去以下页面下载：<a class="reference download internal" download="" href="../../../_downloads/9b6f609933864f84f4407176b25bb7ce/03-online_doc.htm"><span class="xref download myst">链接</span></a>。</p>
<p><strong><img alt="" src="10-Technology/03-MC/08-FAQ/images/4.gif" /> 注意： 如果想要在 CPU
掉电、STOP 到 RUN
或者工艺对象重启之后，对工艺数据块所做的更改仍然保留，则必须使用扩展指令&quot;WRIT_DBL&quot;将这些更改写入装载存储器的起始值中。</strong></p>
</section>
<section id="id6">
<h2>变量访问举例<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>&lt;轴名称&gt;.Positon</p></li>
<li><p>&lt;轴名称&gt;.Velocity</p></li>
<li><p>&lt;轴名称&gt;.ActualPosition</p></li>
<li><p>&lt;轴名称&gt;.ActualVelocity</p></li>
</ul>
<p>以上变量支持的访问方式见表 3，有 2 种访问方式：RCCP、RP。</p>
<p>表 3. 位置速度说明</p>
<p>±----------------±----------------±----------------±----------------+
| :::             | :::             | :::             | :::             |
|  {align=“left”} |  {align=“left”} |  {align=“left”} |  {align=“left”} |
| 变量            | 数据类型        | 访问            | 说明            |
| :::             | :::             | :::             | :::             |
±----------------±----------------±----------------±----------------+
| :::             | :::             | :::             | :::             |
|  {align=“left”} |  {align=“left”} |  {align=“left”} |  {align=“left”} |
| Position        | REAL            | RCCP、 PR       | 轴的位置设定值  |
| :::             | :::             | :::             | :::             |
±----------------±----------------±----------------±----------------+
| :::             | :::             | :::             | :::             |
|  {align=“left”} |  {align=“left”} |  {align=“left”} |  {align=“left”} |
| Velocity        | REAL            | RCCP、 PR       | 轴的速度设定值\ |
| :::             | :::             | :::             | :::             |
±----------------±----------------±----------------±----------------+
| :::             | :::             | :::             | :::             |
|  {align=“left”} |  {align=“left”} |  {align=“left”} |  {align=“left”} |
| ActualPosition  | REAL            | RCCP、 PR       | 轴的实际位置\   |
| :::             | :::             | :::             | :::             |
±----------------±----------------±----------------±----------------+
| :::             | :::             | :::             | :::             |
|  {align=“left”} |  {align=“left”} |  {align=“left”} |  {align=“left”} |
| ActualVelocity  | REAL            | RCCP、 PR       | 轴的实际速度\   |
| :::             | :::             | :::             | :::             |
±----------------±----------------±----------------±----------------+</p>
<p>如果应用中需要更实时的变量值，可以使用&quot;MC_ReadParam&quot;读取变量（RP
方式），此时获得的变量数值为&quot;MC_ReadParam&quot;命令启动时的数值。</p>
<p>直接读取变量时（RCCP
方式），变量的值在每个周期控制更新点更新，值在控制更新点更新前不会变化，数据实时性较RP方式差。</p>
</section>
<section id="id7">
<h2>变量更改有效性举例<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h2>
<p>&lt;轴名称&gt;.DynamicDefaults.&lt;变量名称&gt;
中包含有动态默认值的组态，更改变量时的具体信息见表 4 ：</p>
<p>表 4. 动态默认值</p>
<p>±----------±----------±----------±----------±----------±----------+
| ::: {alig |           | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} |           | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| 变量      |           | 数据类型  | 访问      | W         | 说明      |
| :::       |           | :::       | :::       | :::       | :::       |
±----------±----------±----------±----------±----------±----------+
| ::: {alig |           | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} |           | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| Dynamic   |           | STRUCT    | :::       | :::       | TO_Stru   |
| Defaults. |           | :::       |           |           | ct_Dynami |
| :::       |           |           |           |           | cDefaults |
|           |           |           |           |           | :::       |
±----------±----------±----------±----------±----------±----------+
| ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| :::       | Acc       | REAL      | RW、 WP   | 5、6、10  | 轴        |
|           | eleration | :::       | :::       | :::       | 的加速度  |
|           | :::       |           |           |           | :::       |
±----------±----------±----------±----------±----------±----------+
| ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| :::       | Dec       | REAL      | RW、 WP   | 5、6、10  | 轴        |
|           | eleration | :::       | :::       | :::       | 的减速度  |
|           | :::       |           |           |           | :::       |
±----------±----------±----------±----------±----------±----------+
| ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| :::       | Jerk      | REAL      | RW、 WP   | 5、10     | 轴斜坡加  |
|           | :::       | :::       | :::       | :::       | 速和减速  |
|           |           |           |           |           | 过程中的  |
|           |           |           |           |           | 加加速度  |
|           |           |           |           |           | :::       |
±----------±----------±----------±----------±----------±----------+
| ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig | ::: {alig |
| n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} | n=“left”} |
| :::       | Eme       | REAL      | RW、 WP   | 1、       | 轴的急    |
|           | rgencyDec | :::       | :::       | 5、6、10  | 停减速度  |
|           | eleration |           |           | :::       | :::       |
|           | :::       |           |           |           |           |
±----------±----------±----------±----------±----------±----------+</p>
<p>1.通过&quot;访问&quot;信息可知
Acceleration、Deceleration、Jerk、EmergencyDeceleration
变量可以在用户程序和 HMI
中直接修改，如轴已禁用，还可通过运动控制命令&quot;MC_WriteParam&quot;修改。</p>
<p>2.通过&quot;W&quot;信息可知：</p>
<p>（1）开环 PTO 控制时</p>
<p>Jerk 变量在下一次启动(W=5 时) MC_MoveAbsolute、
MC_MoveRelative、MC_MoveVelocity、MC_MoveJog、MC_Halt、 MC_CommandTable
或激活的 MC_Home 命令时 (Mode = 3)生效。</p>
<p>Acceleration、Deceleration 变量除了在上述命令启动后生效(W=5)，MC_MoveJog
命令停止时也会生效(W=6 时)。</p>
<p>EmergencyDeceleration 变量除了在 W=5 或 6
外，在轴激活、禁用或已启用时生效（W=1 时）。</p>
<p>（2）通过 PROFIdrive/模拟量输出闭环控制时</p>
<p>下一次调用 MC-Interpolator [OB92] 时(W= 10时)，以上变量生效。</p>
</section>
<section id="mc-power">
<h2><span id="toc10"></span>10. 如何在闭环控制时正确使能 MC_POWER ？<a class="headerlink" href="#mc-power" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>在做 S7-1200
开环运动控制时，如果不需要运行时断开使能，例如急停，通常使用常 1 控制
MC_POWER 的 Enable，这样 CPU 运行即使能，然后就可以执行各种动作。</p>
<p>但是如果是闭环运动控制，MC_POWER
使能的过程是需要和驱动器进行数据交换的，如果还使用常 1 控制 MC_POWER 的
Enable，就可能会出现类似如图 12 所示的故障，然后需要在合适的时间使用
MC_RESET 对每个轴进行复位才可以。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-12.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-12.png" style="width: 557px; height: 283px;" /></a></p>
<p>图 12. 使能报警</p>
<p>原因是因为 CPU 和 驱动器同时上电，但是通常 CPU
启动的比驱动器要快，这样会造成没有通信建立但 CPU
已经启动并执行相应的使能程序，然后造成这样的错误。</p>
<p>为了使 CPU 正常使能驱动器，而无需复位，建议使用以下方法。</p>
<p>首先对轴工艺对象右键选择&quot;打开 DB 编辑器&quot;，如图 13 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-13.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-13.png" style="width: 294px; height: 682px;" /></a></p>
<p>图 13. 打开 DB 编辑器</p>
<p>打开后，能够看到轴工艺对象以 DB 块的形式展现，然后找到如图 14
红框标识的变量，这些是后面编程需要使用的变量，这些变量在 CPU
与驱动器通信交互数据时会自动更新。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-14.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-14.png" style="width: 464px; height: 863px;" /></a></p>
<p>图 14. 打开 DB 编辑器</p>
<p>之后在程序中编写 MC_POWER 使能程序，使用上述变量，如图 15 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-15.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-15.png" style="width: 933px; height: 431px;" /></a></p>
<p>图 15. 使能程序</p>
<p>①判断驱动是否通信正常，正常为 True</p>
<p>②判断驱动参数是否传递正常或无需传递，传递正常值为 2，无需传递值为 3</p>
<p>③判断编码器状态是否有效，有效值为 2</p>
<p>④判断编码器是否通信正常，正常为 True</p>
<p>⑤判断编码器参数是否传递正常或无需传递，传递正常值为 2，无需传递值为 3</p>
<p>上述 ② 驱动与 ⑤
编码器参数传递，取决于轴工艺对象组态&quot;运行时自动应用驱动/编码器值（在线）&quot;，如图
16
所示红框。如果需要在线传递驱动/编码器参数则激活该选项，如果无需传递则不激活。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-16.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-16.png" style="width: 990px; height: 206px;" /></a></p>
<p>图 16. 运行时自动应用</p>
<p>考虑到可能会在运行时取消驱动器使能，这样可以在使能条件前加用户条件，当条件满足时再使能，可以参考如图
17 的程序。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-17.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-17.png" style="width: 1043px; height: 424px;" /></a></p>
<p>图 17. 使能程序</p>
</section>
<section id="fb">
<h2><span id="toc11"></span>11. 如何对运动控制指令使用 FB 进行封装？<a class="headerlink" href="#fb" title="此标题的永久链接">¶</a></h2>
<p>答：</p>
<p>如果在有多个轴，并且每个轴都使用很多 MC 的指令时，通常会考虑对使用的 MC
指令使用 FB
进行封装，以多重背景的方式调用，而非产生很多的背景数据块。对于一些设定控制位、设定值，例如使能、触发或者速度、位置等可以很方便的在
FB 的输入上定义，除此以外，对于轴参数也需要定义在接口参数中，否则该 FB
就无法实现多次调用。</p>
<p>轴参数的类型是 TO_PositioningAxis，可以在 FB
输入或者输入输出参数予以使用，如图 18 所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-18.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-18.png" style="width: 249px; height: 176px;" /></a></p>
<p>图 18. 定义接口</p>
<p>如果参数类型太长记不住，可以按照如图 19
所示的方法找到该类型，复制到块接口即可。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-19.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-19.png" style="width: 1062px; height: 675px;" /></a></p>
<p>图 19. 接口参数</p>
<p>这样就可以在调用 FB 时，方便的把轴工艺 DB 作为 FB 的实参使用了，如图 20
所示。</p>
<p><a class="reference internal" href="10-Technology/03-MC/08-FAQ/images/1-20.png"><img alt="" src="10-Technology/03-MC/08-FAQ/images/1-20.png" style="width: 556px; height: 132px;" /></a></p>
<p>图 20. 调用 FB</p>
<p>除此以外，命令表参数的类型是 TO_CommandTable，同样也可以使用图 19
的方式在命令表工艺对象 DB 处获取。</p>
<p>此外，DB_ANY 也可以应用在运动控制指令封装 FB
中，可以参考<a class="reference internal" href="#../../../07-Program/02-basic/01-Data_Type/08-DB_ANY.html#motion"><span class="xref myst">链接</span></a>。</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#"><span id="toc428444757">S7-1200 运动控制的常见问题</span></a><ul>
<li><a class="reference internal" href="#id1"><span id="toc"></span>1. 绝对定位和相对定位区别？</a></li>
<li><a class="reference internal" href="#mc-moverelative"><span id="toc2"></span>2. 如何设置 MC_MoveRelative 方向运行？</a></li>
<li><a class="reference internal" href="#done-1"><span id="toc3"></span>3. 为什么有时用户在监控程序的时候看不到指令的完成位 Done 的为 1？</a></li>
<li><a class="reference internal" href="#id2"><span id="toc4"></span>4. 开环运动控制怎样计算运动任务？</a></li>
<li><a class="reference internal" href="#s7-1200-pto-v90-pti"><span id="toc5"></span>5. 为何通过 S7-1200 PTO 方式控制 V90 PTI 定位换向时有时会有丢失脉冲的情况?</a></li>
<li><a class="reference internal" href="#id3"><span id="toc6"></span>6. 如何通过数据块实现驱动装置/编码器的数据连接？</a></li>
<li><a class="reference internal" href="#s7-1200-hsp-v90-pn"><span id="toc7"></span>7. S7-1200 工艺对象能否控制由硬件支持包（HSP）方式组态的 V90 PN?</a></li>
<li><a class="reference internal" href="#id4"><span id="toc8"></span>8. 如何在轴运动过程中修改目标速度与目标位置？</a></li>
<li><a class="reference internal" href="#id5"><span id="toc9"></span>9. 在运行期间如何对工艺对象的变量进行读写访问</a></li>
<li><a class="reference internal" href="#id6">变量访问举例</a></li>
<li><a class="reference internal" href="#id7">变量更改有效性举例</a></li>
<li><a class="reference internal" href="#mc-power"><span id="toc10"></span>10. 如何在闭环控制时正确使能 MC_POWER ？</a></li>
<li><a class="reference internal" href="#fb"><span id="toc11"></span>11. 如何对运动控制指令使用 FB 进行封装？</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
            </div>

            <div class="right">
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; 版权所有 2024, 宁波双紫信息科技有限公司.
      最后更新于 8月 24, 2024.
      由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2创建。
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>