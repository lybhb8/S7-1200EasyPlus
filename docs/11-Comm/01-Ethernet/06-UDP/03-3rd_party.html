<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>UDP和调试助手</title>
<link href="mnp.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h3>UDP和调试助手</h3>
<p>S7-1200支持UDP单播和UDP广播，不支持UDP组播。UDP是一种无连接的通信协议，通过调用TSEND_C、TRCV_C、TCON等指令可以与其他设备或软件进行UDP通信。</p>
<p>本示例中使用的软件和硬件环境：</p>
<p>① TIA Portal V16</p>
<p>② TCP/UDP Socket调试工具</p>
<p>③ CPU1214C DC/DC/DC(6ES7 214-1AG40-0XB0),V4.4</p>
<p>④ PC </p>
<p>⑤ 以太网线</p>
<p>需要完成的通信任务：</p>
<p>S7-1200和调试助手进行数据通信</p>
<h3>通信设置</h3>
<h4>调试助手设置</h4>
<p>1、打开调试软件，选中左方的UDP Server，点击&ldquo;创建&ldquo;按钮。如图1所示：</p>
<strong><img src="images/03-01.PNG" width="271" height="135" alt=""/></strong><strong></strong>

<p>图1.Socket创建UDP</p>

<p>2、软件弹出端口输入框。如图2所示：</p>
<p><img src="images/03-02.jpg" width="310" height="185" alt=""/></p>
<p>图2.Socket设置端口号</p>

<p>3、输入端口后，软件会在收到对方数据后更新对方信息。如图3所示：</p>
<img src="images/03-03.PNG" width="706" height="151" alt=""/>
  <p>图3.Socket设置完成</p>
<h4>S7-1200设置</h4>
<p>1、打开TIA Portal V16,创建一个新项目,添加CPU1214C DC/DC/DC V4.4并设置CPU的IP地址。如图4所示： </p>
<strong><img src="images/03-04.jpg" width="1033" height="633" alt=""/></strong>

  <p>图4.S7-1200设置IP地址</p>

<p>2、添加TCP通信指令。如图5所示：</p>
<img src="images/03-05.jpg" width="713" height="353" alt=""/>

  <p>图5.调用通信指令</p>

<p><strong>注意</strong>：TSEND_C只能实现S7-1200单播，实现广播需要使用TCON+TUSEND指令。</p>
<p>3、对通信进行组态。如图6所示：</p>
<img src="images/03-06.jpg" width="818" height="546" alt=""/>

  <p>图6.组态通信</p>

<p>4、编写发送和接收指令。如图7所示：</p>
<img src="images/03-07.PNG" width="561" height="521" alt=""/>

<p>图7.数据收发指令</p>

<h3>通信测试</h3>
<p>编译保存项目，下载至CPU。监控数据交互，如图8所示： </p>
<img src="images/03-08.png" width="791" height="401" alt=""/>

  <p>图8.数据交互</p>
  <p>注意：调试助手发送的ASCII格式的123456789，所以CPU收到的是十六进制的313233343536373839。</p>

</body>
</html>
