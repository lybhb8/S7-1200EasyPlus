<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>PC 端访问 Web 服务器</title>
<link href="mnp.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h3>PC 端访问 Web 服务器</h3>
<p>从 PC 端访问 Web 服务器，一般情况下 PC 和 PLC 在同一个局域网中，否则就需要设置路由，这里不对路由访问进行介绍。</p>
<p>需要在浏览器地址栏中输入 HTTP://ww.xx.yy.zz 或者 HTTPS://ww.xx.yy.zz。其中，HTTP 表示非安全访问，HTTPS 表示安全访问；ww.xx.yy.zz 表示 S7-1200 CPU 的 IP 地址。</p>
<p>不同的浏览器证书的下载以及证书管理器的位置有可能会有不同，本文档使用的是 IE11 浏览器。</p>
<p>PC 端访问 S7-1200 Web 服务器有以下几种情况，按需使用即可：</p>
<ul>
  <li><strong><a href="04-WebServer_AccessFromPC.html#a">HTTP://访问（不安全，不推荐）</a></strong></li>
  <li><strong><a href="04-WebServer_AccessFromPC.html#b">HTTPS://访问，浏览器中添加例外</a></strong></li>
  <li><strong><a href="04-WebServer_AccessFromPC.html#c">HTTPS://访问，在浏览器中下载 / 另存证书并导入到浏览器证书管理器中</a></strong></li>
  <li><strong><a href="04-WebServer_AccessFromPC.html#d">HTTPS://访问，博途中导出证书并且导入到浏览器证书管理器中</a></strong></li>
</ul>
<p>手机端访问 Web 服务器的方法，可以参考：<a href="05-WebServer_AccessFromMobile.html"><strong>手机端访问 Web 服务器</strong></a></p>
<h4>硬件和软件版本</h4>
<p>以下是本文档中所使用的硬件和软件：</p>

  <p><strong>PLC：</strong></p>
<ul>
    <li>S7-1200  V4.5 及以上 （本文档使用硬件： 6ES7 214-1AG40-0XB0 V4.5 版本）</li>
</ul>
<p><strong>编程软件：</strong></p>
  <ul>
    <li>TIA Portal V17 及以上（本文档使用软件：STEP7 Professional V17）  </li>
  </ul>
  <p><strong>交换机：</strong></p>
  <ul>
    <li>SCALANCE X308</li>
  </ul>
<p> PC 和 PLC 分别连接到交换机上，IP 地址设置如下：</p>
<ul>
  <li>PC：192.168.0.222</li>
  <li>PLC：192.168.0.124</li>
</ul>
<h4><strong><a name="a" id="a"></a>情况一：HTTP://访问</strong></h4>
<p>1. 要使用 HTTP 访问 Web 服务器，需要保证在组态 1200Web 服务器时，取消勾选仅允许通过 HTTPS 访问，如图 1 所示。</p>
<p><img src="images/4.gif" width="15" height="15" /><strong>建议勾选仅允许通过 HTTPS 访问！</strong></p>
<p><img src="images/04-01.jpg" width="702" height="363" /></p>
<p>图 1.取消仅允许通过 HTTPS 访问</p>
<p>2. 打开 IE11 浏览器，地址栏中输入 HTTP://192.168.0.124，可以进入到 1200Web 服务器的简介页面，如图 2 所示。</p>
<p><img src="images/04-02.jpg" width="682" height="320" /></p>
<p>图 2.HTTP 访问简介页面</p>
<p>3. 图 2 中点击进入，可以进入到 1200Web 服务器的标准页面，包含起始页面和介绍页面。如图 3 所示。</p>
<p><img src="images/04-03.jpg" width="806" height="430" /></p>
<p>图 3.HTTP 访问标准页面</p>
<p>4. 如果在图 3 中，输入用户名和密码，用户登录以获取相应的访问权限，可以观察到访问自动切换至 HTTPS。如图 4 所示。</p>
<p><img src="images/04-04.jpg" width="645" height="272" /></p>
<p>图 4.HTTP 访问用户登录</p>
<h4><strong><a name="b" id="b"></a>情况二：HTTPS://访问，浏览器中添加例外</strong></h4>
<p>使用 HTTPS:// 连接 S7-1200 时，网站将通过数字证书对会话进行加密。Web 服务器将安全地发送数据，不会被任何人看到。</p>
<p>1. 打开 IE11 浏览器，在地址栏中应输入 HTTPS://192.168.0.124。弹出安全警告窗口提示此站点不安全。点击详细信息，然后，点击转至此网页（不推荐）。如图 5 所示。点击转至此网页（不推荐）的操作，相当于为浏览器将此访问作为一个安全例外。</p>
<p><img src="images/04-05.jpg" width="717" height="464" /></p>
<p>图 5.HTTPS 访问点击转至此网页</p>
<p>3. 点击转到此网页（不推荐）后，可访问简介页面，但是，地址栏会提示证书出错，颜色变为红色以作警告。如图 6 所示。</p>
<p><img src="images/04-06.jpg" width="764" height="430" /></p>
<p>图 6.添加例外并访问简介页面</p>
<p>4. 图 6 中点击进入，进入标准页面后在左上角输入用户明和密码，可成功登陆，获取到该用户所拥有的访问权限。如图 7 所示。</p>
<p><img src="images/04-07.jpg" width="767" height="652" /></p>
<p>图 7.添加例外后用户登陆</p>
<p><img src="images/4.gif" width="15" height="15" /><strong>使用添加例外的方式访问 Web 服务器，有可能在关闭浏览器后再重新访问 Web 服务器时，依然出现安全警告，在地址栏显示证书错误！</strong></p>
<h4><strong><a name="c" id="c"></a>情况三：在浏览器中下载 / 另存证书并导入到浏览器证书管理器中</strong></h4>
<p>使用 HTTPS:// 连接 S7-1200 时，需要进行证书的验证以确定身份。为了避免添加例外的方式，重新访问时总是提示安全警告，可以在浏览器的证书管理器中安装证书。</p>
<p>1. 打开 IE11 浏览器，输入 HTTPS://192.168.0.124</p>
<p>弹出安全警告窗口提示此站点不安全。点击详细信息，然后，点击转至此网页（不推荐），参考图 5。</p>
<p>跳转到 Web 服务器的简介页面，在浏览器地址栏中点击证书错误然后点击查看证书，如图 8 所示。或者在简介页面右上角点击&ldquo;下载证书&rdquo;，然后点击打开，如图 9 所示。</p>
<p><img src="images/04-08.jpg" width="765" height="379" /></p>
<p>图 8.浏览器中查看证书</p>
<p><img src="images/04-09.jpg" width="768" height="382" /></p>
<p>图 9.Web 服务器简介页面下载证书</p>
<p>2. 打开证书后，可以看到证书的参数</p>
<p>如果在博途中对 Web 服务器 Security 属性中选择不同类型，生成的证书信息也不同，点击图中安装证书，如图 10 - 图 12 所示。</p>
<p>选择：已生成的硬件，证书为如图 10 所示，证书的颁发者和使用者为 S7-1200 Controller Family，证书有效期从 2012-1-1 到 2042-1-1，不可修改，即便 CPU 做过复位或者恢复出厂设置，CPU 的模块时间也满足要求。</p>
<p>选择：已下载的软件，没有进行安全设置，生成自签署证书，证书如图 11 所示，证书的颁发者和使用者一致，有效期起始值和结束值可自行设置，所以需要检查 CPU 模块时间是否在有效期内。</p>
<p>选择：已下载的软件，进行安全设置，生成由 CA 签署的证书，证书如图 12 所示，证书有颁发机构，有使用者，有效期起始值和结束值可自行设置，所以需要检查 CPU 模块时间是否在有效期内。</p>
<p><img src="images/04-10.jpg" width="467" height="657" /></p>
<p>图 10. 安装证书（硬件生成的证书）</p>
<p>  <img src="images/04-11.jpg" width="466" height="654" /> </p>
<p>图 11. 安装证书（自签署证书）</p>
<p><img src="images/04-12.jpg" width="467" height="658" /></p>
<p>图 12. 安装证书（由 CA 签署的证书）</p>
<p><strong><img src="images/4.gif" alt="" width="15" height="15" />注意：不同浏览器下载证书的方式不同，有的浏览器需要保存证书，然后对证书进行导入</strong>！</p>
<p>3. 在证书导入向导中选择本地计算机，如图 13 所示。</p>
<p><img src="images/04-13.jpg" width="560" height="439" /></p>
<p>图 13.选择本地计算机</p>
<p>4. 在证书导入向导中选择将所有的证书都放入下列存储，然后点击浏览选择存放的路径，此处选择第三方根证书颁发机构，如图 14 所示。</p>
<p><img src="images/04-14.jpg" width="558" height="340" /></p>
<p>图 14.选择证书存储路径</p>
<p>5. 证书导入完成，单击确认退出证书导入向导，如图 15 所示。</p>
<p><img src="images/04-15.jpg" width="605" height="595" /></p>
<p>图 15.证书导入完成</p>
<p>6. 在浏览器中安装证书之后，再以 https://192.168.0.124 访问 Web 服务器时就不会再出现安全验证提示，可以直接跳转到 S7-1200 的 Web 服务器页面。</p>
<p>此时可以点击左上角的用户登录位置，输入正确的用户名称和密码。如图 16 所示。</p>
<p><img src="images/04-16.jpg" width="845" height="601" /></p>
<p>图 16.登录 Web 服务器</p>
<h4><strong><a name="d" id="d"></a>情况四：HTTPS://访问，博途中导出证书并且导入到浏览器证书管理器中</strong><strong></strong></h4>
<p>在情况三：在浏览器中下载 / 另存证书并导入到浏览器证书管理器中，是先添加例外，然后直接在浏览器中下载/安装证书。</p>
<p>在情况四中，直接从博途中导出证书，然后导入到浏览器的证书管理其中，这样再使用 HTTPS://访问时，直接可以安全的访问 Web 服务器了。</p>
<p><strong>情况四，仅适用于证书类型选择已下载的软件</strong>。</p>
<h4>情况四（之一）：博途导出自签署证书，并导入到浏览器证书管理器中</h4>
<p>1. 从博途中导出服务器证书</p>
<p>CPU 属性 Web 服务器，Security 中证书类型选择：已下载的软件，自签署证书时，导出证书并存放在某一路径。如图 17 - 图 18 所示。</p>
<p><img src="images/04-17.jpg" width="741" height="438" />  </p>
<p>图 17.导出证书</p>
<p><img src="images/04-18.jpg" width="607" height="302" /></p>
<p>图 18.选择保存位置</p>
<p>2. 打开浏览器，点击设置按钮，下拉菜单中选择 Internet 选项，如图 19 所示。</p>
<p><img src="images/04-19.jpg" width="373" height="374" /> </p>
<p>图 19.打开 Internet 选项</p>
<p>3. 在 Internet 选项中点击内容按钮，点击证书按钮，如图 20 所示。</p>
<p><img src="images/04-20.jpg" width="476" height="369" /></p>
<p>图 20.点击证书按钮</p>
<p>4. 在证书管理器中点击导入按钮，如图 21 所示。</p>
<p><img src="images/04-21.jpg" width="586" height="435" /></p>
<p>图 21.点击导入按钮</p>
<p>5. 在证书导入向导中点击浏览按钮，并且到存储证书的路径选中之前导出的证书。如图 22 - 图 23 所示。</p>
<p><img src="images/04-22.jpg" width="614" height="394" /></p>
<p>图 22.点击浏览</p>
<p><img src="images/04-23.jpg" width="601" height="320" /></p>
<p>图 23.浏览并选中证书</p>
<p>6. 在证书导入向导中选择将所有的证书都放入下列存储，点击浏览，选择受信任的根证书颁发机构，如图 24 所示。</p>
<p><img src="images/04-24.jpg" width="564" height="347" /></p>
<p>图 24.将证书导入到受信任的根证书颁发机构</p>
<h4>情况四（之二）：博途导出由 CA 签署的证书，并导入到浏览器证书管理器中</h4>
<p>此处仅列出与情况四（之一）的不同之处：</p>
<p><strong>不同点一：从博途中导出证书的位置不同</strong></p>
<p>1. Web 服务器组态使用的证书如果是 CA 签署的证书，从项目树，安全设置，安全特性中的证书管理器中，点击<strong>证书颁发机构</strong>，选择签发证书的 CA，右键导出。如图 25 所示。</p>
<p><img src="images/04-25.jpg" width="1120" height="312" /></p>
<p>图 25.导出证书颁发机构</p>
<p>2. 导出的证书保存在设置的位置，如图 26 所示。</p>
<p><img src="images/04-26.jpg" width="608" height="320" /></p>
<p>图 26.选择证书导出路径</p>
<p>3. 导出证书对话框中选择导出按钮，如图 27 所示。</p>
<p><img src="images/04-27.jpg" width="598" height="280" /></p>
<p>图 27.点击导出按钮确认导出</p>
<p><strong>不同点二：向浏览器证书管理器中导入证书时，选择文件类型为所有类型，如图 28 所示。</strong></p>
<p><img src="images/04-28.jpg" width="609" height="355" /></p>
<p>图 28.选择文件类型为所有文件</p>
</body>
</html>
