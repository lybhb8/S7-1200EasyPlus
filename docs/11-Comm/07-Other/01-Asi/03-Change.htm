<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>Change</title>
<link href="mnp.css" rel="stylesheet" type="text/css" />
</head>

<body>
<h3>修改 AS-i 从站地址</h3>
<h4><a name="addr1"></a>1、通过“在线和诊断”设置 AS-i 从站地址</h4>
<p>项目在线后，打开“设备视图”，在 CM1243-2 模块上点击鼠标右键，选择”在线和诊断“功能，如图1所示：</p>
<p><img src="images/3-01.jpg" width="406" height="658"></p>
<p>图1. 打开 CM1243-2 的在线和诊断 </p>
<p>进入在线诊断界面，在”诊断――&gt;详细诊断――&gt;错误概览“菜单下，可看到有组态的从站地址和实际的不符，出现如图2所示的状态：</p>
<p><img src="images/3-02.jpg" width="547" height="570"></p>
<p>图2. 从站状态诊断</p>
<p>接着，需要进入”功能――控制面板“操作修改从站地址，如下图3所示，将实际的2号站改为了和组态一致的1号站地址：</p>
<p><img src="images/3-03.jpg" width="557" height="460"></p>
<p>图3. 2号站改为1号站 </p>
<p>如下图4所示，将实际的3号站改为了和组态一致的2号站地址：</p>
<p><img src="images/3-04.jpg" width="550" height="458"></p>
<p>图4. 3号站改为2号站 </p>
<p>修改地址完毕，回到”诊断――&gt;详细诊断――&gt;错误概览“菜单下，可看到项目中组态的从站地址和实际的完全相同，出现如图5所示的正确状态：</p>
<p><img src="images/3-05.jpg" width="550" height="577">.</p>
<p>图5. 从站地址完全匹配 </p>
<h4><a name="addr2"></a>2、通过指令编程设置 AS-i 从站地址</h4>
<p>CM1243-2 手册章节7.2.2.9 所描述的命令，可用于使用指令“WRREC”将索引号 20 发送命令修改 AS-i 从站地址，命令格式如图6所示：</p>
<p><img src="images/3-06.jpg" width="667" height="170"></p>
<p>图6. 修改从站地址命令结构</p>
<p>首先，已经通过 TIA Portal 软件组态正确组态 AS-i 主站和从站，如果从站地址不正确则使得 CM1243-2 “CER” 指示黄色灯常亮，“DIAG”指示灯红色闪烁，此时可使用指令“RDREC”将索引号 20 发送命令修改 AS-i 从站地址，编程如图7所示：</p>
<p><img src="images/3-07.jpg" width="763" height="370"></p>
<p>图7. 调用 WRREC 指令</p>
<p>然后，选择 AS-i 主站的硬件 ID 号，并填写该指令的相关参数，如图8所示： </p>
<p><img src="images/3-08.jpg" width="529" height="584"></p>
<p>图8. 填写 WRREC 指令相关参数</p>
<p>注意：新的 AS-i 从站出厂的默认地址为0，请改完一个新从站后，再往 AS-i 总线上安装下一个新从站，以保证 AS-i 总线上不会同时出现两个0号地址！ </p>
<p>本例中，配置的总线上有两个从站，1号从站为DI模块，2号从站为AI模块；&#13;而实际的总线上为2号从站为DI模块，3号从站为AI模块；&#13;故需要通过编程将2号站改为1号站，再将3号站改为2号站。</p>
<p>步骤一：将2号站改为1号站，如图9所示：</p>
<p><img src="images/3-09.jpg" width="651" height="161">&#13;</p>
<p>图9. 将2号站改为1号站</p>
<p>步骤二：将3号站改为2号站，如图10所示：</p>
<p><img src="images/3-10.jpg" width="648" height="161"></p>
<p>图10. 将3号站改为2号站</p>
<p>修改地址完毕，回到”诊断――&gt;详细诊断――&gt;错误概览“菜单下，可看到项目中组态的从站地址和实际的完全相同，出现如图11所示的正确状态：</p>
<p><img src="images/3-05.jpg" width="550" height="577">.</p>
<p>图11. 从站地址完全匹配 </p>

</body>
</html>
